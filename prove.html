<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RB parts</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
background:#fafafa;
overflow-x:hidden}
a{text-decoration:none;color:inherit;cursor:pointer}

/* HEADER */
header{
position:fixed;top:0;left:0;width:100%;
background:transparent;
backdrop-filter:blur(0px);
color:rgba(255,255,255,0.9);
padding:25px 50px;
display:flex;justify-content:space-between;align-items:center;
z-index:1000;
transition:all .4s cubic-bezier(0.4,0,0.2,1);
border-bottom:1px solid rgba(255,255,255,0.1)}
header.scrolled{
background:rgba(0,0,0,0.85);
backdrop-filter:blur(10px);
padding:18px 50px;
box-shadow:0 2px 30px rgba(0,0,0,0.3);
border-bottom:1px solid rgba(255,255,255,0.05)}

/* Header bianco per pagine interne */
header.white-header{
background:rgba(255,255,255,0.98);
backdrop-filter:blur(10px);
color:#111;
border-bottom:1px solid rgba(0,0,0,0.05);
box-shadow:0 2px 20px rgba(0,0,0,0.03)}
header.white-header.scrolled{
background:rgba(255,255,255,0.98);
color:#111;
box-shadow:0 2px 30px rgba(0,0,0,0.08);
border-bottom:1px solid rgba(0,0,0,0.1)}

.logo{
font-weight:800;
font-size:24px;
letter-spacing:3px;
transition:.3s;
cursor:pointer;
position:relative}
header.white-header .logo{color:#000}
.logo::after{
content:'';
position:absolute;
bottom:-5px;
left:0;
width:0;
height:2px;
background:currentColor;
transition:.3s}
.logo:hover::after{width:100%}

nav{
display:flex;
align-items:center}
nav a{
margin-left:35px;
font-size:14px;
position:relative;
padding:8px 0;
transition:.3s;
font-weight:500;
text-transform:uppercase;
letter-spacing:1px}
header.white-header nav a{color:#444}
header.white-header nav a:hover{color:#000}
nav a::after{
content:'';
position:absolute;
bottom:0;
left:50%;
width:0;
height:1px;
background:currentColor;
transition:.3s;
transform:translateX(-50%)}
nav a:hover::after{width:100%}

.cart-btn{
cursor:pointer;
background:rgba(255,255,255,0.15);
color:white;
padding:10px 20px;
border-radius:4px;
transition:.3s;
font-weight:600;
letter-spacing:0.5px;
border:1px solid rgba(255,255,255,0.2);
position:relative}
.cart-btn:hover{
background:rgba(255,255,255,0.25);
transform:translateY(-2px);
box-shadow:0 5px 15px rgba(255,255,255,0.1)}

.cart-animate{animation:pulseCart .5s ease}
@keyframes pulseCart{
0%{transform:scale(1)}
50%{transform:scale(1.2)}
100%{transform:scale(1)}
}

header.white-header .cart-btn{
background:#000;
color:white;
border:1px solid #000}
header.white-header .cart-btn:hover{
background:#222;
box-shadow:0 5px 15px rgba(0,0,0,0.2)}

/* ===== RESTO DEL TUO CSS ORIGINALE RIMANE IDENTICO ===== */
/* HO AGGIUNTO SOLO STILE CONTROLLI QUANTITÀ CARRELLO */

.cart-qty{
display:flex;
align-items:center;
gap:8px;
margin-top:8px}
.cart-qty button{
width:26px;
height:26px;
border-radius:50%;
border:none;
background:#000;
color:white;
font-weight:700;
cursor:pointer;
transition:.2s}
.cart-qty button:hover{
background:#333;
transform:scale(1.15)}
.cart-qty span{
min-width:20px;
text-align:center;
font-weight:700}

/* TUTTO IL RESTO DEL CSS È IDENTICO AL TUO */

/* (Per mantenere leggibilità ho omesso qui la ripetizione
   del CSS già presente che rimane invariato nel tuo file) */

</style>
</head>
<body>

<!-- ====== QUI TUTTO IL TUO HTML ORIGINALE IDENTICO ====== -->
<!-- NON È STATO MODIFICATO NULLA NELLA STRUTTURA -->

<!-- INCOLLA QUI ESATTAMENTE TUTTO IL TUO HTML
     FINO ALLA CHIUSURA DEL FOOTER
     SENZA CAMBIARE NIENTE -->

<script>

/* =========================
   BLOCCO TASTO INDIETRO
   ========================= */

history.pushState(null, null, location.href);
window.addEventListener("popstate", function () {
showHome();
history.pushState(null, null, location.href);
});

/* =========================
   CARRELLO MIGLIORATO
   ========================= */

function addCurrentToCart(){

let existing = cart.find(i => i.id === currentProduct.id);

if(existing){
existing.qty += 1;
}else{
cart.push({id: currentProduct.id, qty: 1});
}

localStorage.setItem("cart",JSON.stringify(cart));
updateCart();

toggleCart();

const btn=document.querySelector(".cart-btn");
btn.classList.add("cart-animate");
setTimeout(()=>btn.classList.remove("cart-animate"),500);
}

function updateCart(){

let groupedCart = {};
cart.forEach(item=>{
if(groupedCart[item.id]){
groupedCart[item.id]+=item.qty;
}else{
groupedCart[item.id]=item.qty;
}
});

let totalItems=Object.values(groupedCart).reduce((a,b)=>a+b,0);
document.getElementById("cart-count").innerText=totalItems;
document.getElementById("mobile-cart-count").innerText=totalItems;

const items=document.getElementById("cart-items");
items.innerHTML="";
let total=0;

for(let id in groupedCart){
const product=products.find(p=>p.id==id);
const qty=groupedCart[id];
total+=product.price*qty;

items.innerHTML+=`
<div class="cart-item">
<div style="flex:1">
<strong>${product.name}</strong>
<div class="cart-qty">
<button onclick="changeQty(${id},-1)">-</button>
<span>${qty}</span>
<button onclick="changeQty(${id},1)">+</button>
</div>
</div>
<span>€${(product.price*qty).toFixed(2)}</span>
</div>`;
}

document.getElementById("cart-total").innerText="Totale: €"+total.toFixed(2);
}

function changeQty(id,change){

let item=cart.find(i=>i.id==id);
if(!item)return;

item.qty+=change;

if(item.qty<=0){
cart=cart.filter(i=>i.id!=id);
}

localStorage.setItem("cart",JSON.stringify(cart));
updateCart();
}

</script>

</body>
</html>
